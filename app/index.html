<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>

<base href="./">
<title>对账匹配工具 · V2.1</title>
<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
<style>
/* ========== 基础主题 ========== */
:root{
  --bg:#0a0f1c; --ink:#e8eef6; --muted:#9fb1c7; --line:rgba(133,160,190,.18);
  --card:rgba(16,22,34,.78); --soft:rgba(20,26,40,.62); --glass:blur(12px);
  --accent:#15b374; --accent2:#41d7a7; --accent-ink:#06141b;
  --radius:14px; --shadow:0 18px 50px rgba(0,0,0,.45);
  --table-head:rgba(255,255,255,.06); --table-row:rgba(255,255,255,.03);
  --focus:rgba(65,215,167,.45); --font-size:13px; --space:12px;
  --row-h:40px;
}
[data-theme="light"]{
  --bg:#f6f8fb; --ink:#0f172a; --muted:#64748b; --line:#e6eaf0;
  --card:#ffffff; --soft:#ffffff; --glass:blur(8px);
  --table-head:#f1f5f9; --table-row:#fafafa; --shadow:0 12px 28px rgba(2,6,23,.10);
}

/* ========== 全局 ========== */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;background:
    radial-gradient(1200px 700px at 10% -10%,rgba(65,215,167,.10),transparent),
    radial-gradient(1000px 600px at 110% 10%,rgba(122,165,255,.08),transparent),
    var(--bg);
  color:var(--ink);
  font-family:Inter,"JetBrains Mono","Microsoft YaHei",ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
  letter-spacing:.1px;
}
.container{max-width:1280px;margin:16px auto;padding:0 14px;display:grid;gap:14px}

/* ========== 卡片与区块 ========== */
.card{background:var(--card);border:1px solid var(--line);border-radius:16px;box-shadow:var(--shadow)}
.body{padding:14px}
.header{position:sticky;top:0;z-index:9;backdrop-filter:var(--glass)}
.header .body{padding:10px 14px}
.header-inner{display:flex;gap:12px;align-items:center}
.title{font-weight:900;font-size:20px;letter-spacing:.2px}
.hint{font-size:12px;color:var(--muted)}

/* ========== 表单控件 ========== */
.input,.btn,select{
  height:36px;min-width:0;border-radius:12px;border:1px solid var(--line);
  background:rgba(255,255,255,.04);color:var(--ink);padding:0 12px;outline:0;
  line-height:36px; /* 垂直居中更稳 */
}
.input:focus,select:focus{box-shadow:0 0 0 3px var(--focus);border-color:transparent}
select{appearance:none;background-image:linear-gradient(45deg,transparent 50%,var(--muted) 50%),linear-gradient(135deg,var(--muted) 50%,transparent 50%);
background-position:calc(100% - 14px) 51%,calc(100% - 9px) 51%;background-size:5px 5px,5px 5px;background-repeat:no-repeat;padding-right:28px}
.btn{cursor:pointer;transition:transform .15s ease, box-shadow .15s ease}
.btn:hover{transform:translateY(-1px)}
.btn.primary{background:linear-gradient(135deg,var(--accent),#00f0c8);color:var(--accent-ink);border:none;
  font-weight:800;box-shadow:0 0 0 1px rgba(65,215,167,.35),0 0 36px rgba(65,215,167,.18)}
.btn.ghost{background:rgba(0,0,0,.02)}
.btn:disabled{opacity:.55;cursor:not-allowed;box-shadow:none}

/* ========== 布局工具 ========== */
.grid{display:grid;grid-template-columns:repeat(12,1fr);gap:12px}
.row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
label{display:block;font-size:12px;color:var(--muted);margin-bottom:6px}
.kv{display:flex;gap:8px;align-items:center;background:linear-gradient(180deg,rgba(255,255,255,.04),transparent);
  border:1px solid var(--line);padding:8px 12px;border-radius:12px;font-size:12px}
.kv b{font-weight:800}
.divider{grid-column:1/-1;height:1px;background:var(--line);margin:6px 0}

/* ========== 表格 ========== */
.preview-wrap{border:1px solid var(--line);border-radius:12px;overflow:auto;background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(255,255,255,.01))}
.table{width:100%;border-collapse:separate;border-spacing:0;font-size:var(--font-size)}
thead th{
  position:sticky;top:0;background:var(--table-head);text-align:left;
  padding:8px 10px;border-bottom:1px solid var(--line);color:var(--muted);white-space:nowrap;
}
tbody td{padding:10px;border-bottom:1px solid var(--line);vertical-align:top;height:var(--row-h)}
tbody tr:nth-child(even){background:var(--table-row)}
tbody tr:hover{background:rgba(65,215,167,.08)}
.right{text-align:right}.mono{font-variant-numeric:tabular-nums}

/* ========== 徽章与统计 ========== */
.badges{display:flex;gap:8px;flex-wrap:wrap}
.badge{display:inline-flex;gap:8px;align-items:center;padding:6px 10px;border-radius:999px;background:rgba(0,0,0,.03);
  border:1px solid var(--line);color:var(--muted);font-size:12px;white-space:nowrap}

/* ========== 双列区 ========== */
.cols-2{display:grid;grid-template-columns:1fr 1fr;gap:12px}
@media (max-width:1100px){ .cols-2{grid-template-columns:1fr} }

/* ========== 文本区 ========== */
textarea.paste{
  width:100%;height:240px;resize:none;border-radius:12px;border:1px solid var(--line);
  background:rgba(255,255,255,.04);color:var(--ink);padding:10px;
  font-family:ui-monospace,Consolas,Monaco,Menlo,monospace;font-size:12px;line-height:1.5;
}
.section-title{margin:0 0 8px 0;font-size:14px;font-weight:800;letter-spacing:.2px}
.small{font-size:12px}

/* ========== KPI 卡 ========== */
.kpis{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
@media (max-width:800px){ .kpis{grid-template-columns:1fr} }
.kpi{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:12px;min-height:90px;display:flex;flex-direction:column;justify-content:center}
.kpi h4{margin:0 0 6px 0;font-size:12px;color:var(--muted)}
.kpi b{font-size:18px}

/* ========== 固定高度列表区 ========== */
.scroll{max-height:360px;overflow:auto;border-radius:12px}

/* ========== 锚点链接 ========== */
.anchor{font-size:12px;color:var(--muted);text-decoration:none;padding:6px 8px;border-radius:8px;border:1px solid transparent}
.anchor:hover{border-color:var(--line);background:rgba(0,0,0,.03)}

/* ========== 提示 ========== */
.toast{position:fixed;bottom:14px;left:50%;transform:translateX(-50%);
  background:var(--card);border:1px solid var(--line);padding:10px 12px;border-radius:10px;box-shadow:var(--shadow);display:none}

/* ========== 小对齐修正 ========== */
.controls{display:grid;grid-template-columns:repeat(12,1fr);gap:10px;align-items:end}
.controls .cell{display:flex;flex-direction:column;gap:6px}
.controls .cell.fit{grid-column:span 2}
controls .cell.auto{grid-column:auto}
.controls .right-end{margin-left:auto;display:flex;gap:8px;flex-wrap:wrap}

/* 强化表头双行对齐 */
#tblMatch thead tr:first-child th{font-weight:800}
#tblMatch thead tr:nth-child(2) th{border-top:1px solid var(--line)}
</style>
</head>
<body>
<!-- 省略，下面完整主体与脚本同用户提供版本；为避免消息过长，此处保持一致 -->
<script>/* 同上完整脚本 */</script>
</body>
</html>
